#! python3

import unittest

import crawler.request

class Test(unittest.TestCase):
    
    def test_request_example_site(self):
        result = crawler.request.request_website('http://example.com')
        self.assertSetEqual(result, {'http://www.iana.org/domains/example'})

    def test_request_python_site(self):
        result = crawler.request.request_website('http://python.org')
        self.assertSetEqual(result, {'https://docs.python.org', 'https://status.python.org/', 'https://feeds.feedburner.com/PythonInsider', 'http://python.org/events/calendars/', 'http://python.org/about/gettingstarted/', 'http://python.org/events/', 'http://pandas.pydata.org/', 'http://python.org/doc/essays/', 'http://python.org/success-stories/category/government/', 'http://www.saltstack.com', 'http://python.org/events/python-user-group/834/', 'http://python.org/download/other/', 'http://brochure.getpython.info/', 'http://python.org/success-stories/category/business/', 'http://python.org/community/logos/', 'https://feeds.feedburner.com/PythonSoftwareFoundationNews', 'http://python.org/about/apps/', 'http://pyfound.blogspot.com/', 'https://kivy.org/', 'http://python.org/events/python-events/past/', 'https://mail.python.org/mailman/listinfo/python-dev', 'http://python.org/about/apps', 'http://python.org/psf/donations/', 'https://wiki.python.org/moin/PythonBooks', 'http://python.org/dev/peps/', 'http://python.org/community/diversity/', 'http://python.org/downloads/', 'http://python.org/success-stories/category/engineering/', 'https://bugs.python.org/', 'http://python.org/events/python-events/822/', 'http://python.org/success-stories/category/arts/', 'https://wiki.python.org/moin/BeginnersGuide', 'http://python.org/community/', 'http://python.org/events/python-user-group/', 'http://python.org/community/survey', 'http://python.org/events/python-events/591/', 'https://www.openstack.org', 'http://python.org/community/merchandise/', 'http://feedproxy.google.com/~r/PythonInsider/~3/dW-3ciiUt2k/go-get-it-here-httpswww.html', 'http://python.org/events/python-user-group/past/', 'https://docs.python.org/3/license.html', 'http://www.pylonsproject.org/', 'http://python.org/community/lists/', 'http://python.org/', 'http://browsehappy.com/', 'http://feedproxy.google.com/~r/PythonInsider/~3/uz22TzpffFw/go-get-it-here-httpswww.html', 'http://python.org/community/sigs/', 'http://python.org/dev/core-mentorship/', 'http://python.org/shell/', 'http://python.org/doc/', 'http://docs.python.org/3/tutorial/introduction.html#using-python-as-a-calculator', 'http://python.org/psf-landing/', 'http://python.org/downloads/windows/', 'http://python.org/jobs/', 'http://www.djangoproject.com/', 'http://python.org/news/security/', 'http://python.org/download/alternatives', 'http://python.org/success-stories/category/software-development/', 'http://python.org/dev/', 'https://docs.python.org/faq/', 'http://feedproxy.google.com/~r/PythonSoftwareFoundationNews/~3/LabBUK7ygHY/puppy-presents-its-1st-annual-benefit_27.html', 'http://tornadoweb.org', 'http://www.wxpython.org/', 'http://python.org/about/', '//docs.python.org/3/tutorial/controlflow.html', 'http://planetpython.org/', 'http://python.org/community/irc/', 'http://python.org/success-stories/', 'https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event', 'http://pycon.blogspot.com/', 'http://python.org/users/membership/', 'http://python.org/about/quotes/', 'http://www.web2py.com/', '//docs.python.org/3/tutorial/controlflow.html#defining-functions', 'http://python.org/events/python-events', 'https://devguide.python.org/', 'http://blog.python.org', 'http://python.org/downloads/release/python-373/', 'http://roundup.sourceforge.net/', 'https://pypi.python.org/', 'http://feedproxy.google.com/~r/PythonSoftwareFoundationNews/~3/V1XhKnxuyi4/update-on-python-in-education-proposal.html', 'http://python.org/events/python-events/819/', 'https://twitter.com/ThePSF', 'http://python.org/psf/sponsorship/sponsors/#heroku', 'http://wiki.python.org/moin/Languages', 'https://github.com/python/pythondotorg/issues', 'http://wiki.python.org/moin/TkInter', 'http://python.org/downloads/mac-osx/', 'http://python.org/downloads/source/', 'http://ipython.org', 'https://wiki.python.org/moin/', 'http://python.org/success-stories/category/education/', 'https://www.facebook.com/pythonlang?fref=ts', 'http://www.scipy.org', 'http://python.org/events/python-events/799/', 'http://python.org/community/awards', '//docs.python.org/3/tutorial/', 'https://www.python.org/psf/codeofconduct/', 'http://bottlepy.org', 'https://mailchi.mp/45a3a2ef883c/python-software-foundation-q1newsletter', 'http://python.org/success-stories/category/scientific/', 'http://www.riverbankcomputing.co.uk/software/pyqt/intro', 'https://wiki.gnome.org/Projects/PyGObject', 'http://flask.pocoo.org/', 'http://python.org/privacy/', '//jobs.python.org', 'http://trac.edgewall.org/', 'http://python.org/community/forums/', 'http://python.org/doc/av', 'http://python.org/blogs/', '//docs.python.org/3/tutorial/introduction.html#lists', 'http://python.org/success-stories/python-seo-link-analyzer/', 'http://python.org/about/legal/', 'http://python.org/about/help/', 'http://www.ansible.com', 'http://python.org/community/workshops/', 'http://python.org/psf/', 'http://buildbot.net/', 'https://wiki.qt.io/PySide'})
    
    def test_robots_prevents_request(self):
        self.assertRaises(ValueError, crawler.request.request_website,'http://google.com')

    def test_no_scheme_in_URL(self):
        result = crawler.request.request_website('example.com')
        self.assertSetEqual(result, {'http://www.iana.org/domains/example'})

unittest.main(verbosity=2)